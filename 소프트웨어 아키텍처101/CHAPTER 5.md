## CHAPTER 5. 아키텍처 특성 식별
- 아키텍처를 구축하거나 기존 아키텍처의 타당성을 검증할 때 가장 먼저 해야하는 일
- 정확히 식별하기 위해서는 해당 도메인을 잘 이해하고 있어야 함
- `도메인 관심사`, `요구사항`, `암묵적 도메인 지식`으로부터 아키텍처 특성을 밝혀낼 수 있음

</br>

## 5.1 도메인 관심사에서 아키텍처 특성 도출
- 아키텍트는 도메인 관심사를 올바르게 해석하여 정확한 아키텍처 특성을 식별해야 함
- 도메인의 핵심 목표와 현재 상황을 고려하여 도메인 관심사를 '~성'으로 해석하고, 그에 따라 합리적 아키텍처를 결정해야 함
- 💡 **TIP. 지원 가능한 아키텍처 특성을 가능한 적게**
   - 특성 하나하나가 전체 시스템 설계를 복잡하게 만드는 요인
   - 특성 개수에 연연하지 말고 가급적 설계를 단순화하는게 좋음

</br>

**아키텍트와 도메인 이해 관계자가 애플리케이션이 지원해야 할 아키텍처 특성 최종 목록에 우선 순위를 둔다면?**
- 시간만 낭비하고 의견이 맞지 않아 불필요한 갈등만 쌓임
- 아키텍처 특성의 우선순위에 만장 일치로 의견이 모아지는 경우는 거의 없음
- 목록에서 각자 중요한 특성 3개를 뽑아 이를 통해 합의를 이끌어내는 것이 좋은 방법

</br>

**대부분의 아키텍처 특성은 핵심 도메인 이해관계자들의 의견을 듣고 정리되나, 아키텍트와 도메인 이해관계자의 언어가 서로 다름**
- 아키텍트는 확장성, 상호운용성, 학습성, 가용성 등을 논함
- 도메인 이해관계자는 인수 병합, 고객 만족, 출시 시점, 경쟁 우위를 논함

</br>

**도메인 관심사를 아키텍처 특성으로 옮긴 표**
|도메인 관심사|아키텍처 특성|
|---|---|
|인수 합병|상호운용성, 확장성, 적응성, 신장성|
|출시 시기|민첩성, 시험성, 배포성|
|유저 만족|성능, 가용성, 내고장성, 시험성, 배포성, 민첩성, 보안|
|경쟁 우위|민첩성, 시험성, 배포성, 확장성, 가용성, 내고장성|
|시간 및 예산|단순성, 실행성|
- 도메인 관심사를 하나의 아키텍처 특성으로만 한정하는 것을 조심해야함
- ex. 도메인 이해관계자가 `당일 펀드 종가가 제시간에 마감돼야 한다`는 요구사항을 제시하는 경우
  - 무능한 아키텍트는 `성능`에만 집중하여 실패하게 됨
  - 유저는 필요한 시점에 시스템을 `사용`할 수 있어야함 (`가용성`)
  - 펀드가 많이 유입되는 경우 제시간에 종가 계산이 가능하도록 규모를 `확장`할 수 있어야 함 (`확장성`)
  - 계산 도중 시스템이 멎으면 안됨 (`안정성`)

</br>

## 5.2 요구사항에서 아키텍처 특성 도출
- 요구사항 정의서에 아키텍처 특성이 명시되어 있는 경우 있음 (ex.예상 유저 수/확장 문제)
- 아키텍트가 알고 있는 도메인 지식에서 도출되는 특성도 있음 (아키텍트가 도메인 지식을 갖고 있으면 이로운 이유)
  - ex. 학사정보시스템을 설계할 때 수강 신청 기간에 학생 수가 몰리는 것을 고려해야함

### [아키텍처 카타](https://nealford.com/katas/list.html)
- 아키텍처 특성을 도출하는 연습을 할 수 있도록 고안한 것
- 아키텍트에게 아래와 같이 도메인 용어와 부가 콘텍스트로 기술된 문제를 제공
  - **설명**: 시스템으로 해결하려는 전체 도메인 문제
  - **유저**: 시스템을 사용할 것으로 예상되는 유저의 유형과 인원수
  - **요구사항**: 아키텍트가 도메인 유저 및 도메인 전문가의 말을 듣고 예상하는 도메인/도메인 수준의 요구사항
  - **부가 콘텍스트**: 요구사항에는 명확하게 기술되어 있지 않지만 아키텍트가 암묵적인 문제 영역에 관한 지식을 이용해 반드시 고려해야할 여러가지 항목들

</br>

## 5.3 사례 연구: 실리콘 샌드위치
### 설명
- 실리콘 샌드위치는 전국 가맹점을 보유한 샌드위치 브랜드로, 온라인 주문 시스템을 구축하려고 한다.
### 유저
- 앞으로 수천 명, 어쩌면 수백만 명에 달할지도 모른다.
### 요구사항
- 유저가 주문을 하면 샌드위치를 픽업하러 갈 시간 및 상점까지 가는 경로를 전달받는다. (교통 정보가 포함된 여러 외부 지도 서비스와의 연계 필수)
- 배달 서비스가 가능한 지점은 기사를 보내 샌드위치를 유저에게 배달한다.
-  모바일 기기에서도 이용가능하다.
- 전국 어느지점이나 이용 가능한 프로모션/스폐셜 행사를 제공한다.
- 특정 지점에서만 이용 가능한 로컬 프로모션/스폐셜 행사를 제공한다.
- 온라인 결제, 대면 결제, 배송 시 결제 등 다양한 결제 옵션을 제공한다.
- 샌드위치 지점은 가맹점이므로 소유자가 다 다르다.
- 모회사는 머지않아 해외 시장도 진출할 계획이다.
- 이 회사는 값싼 인력을 고용해 이윤을 최대화하는 것이 목표다.
### 부가 콘텍스트
- 샌드위치 지점은 가맹점이므로 소유자가 다 다르다.
- 모회사는 머지않아 해외 시장도 진출할 계획이다.
- 이 회사는 값싼 인력을 고용해 이윤을 최대화하는 것이 목표다.


#### 아키텍트의 임무?
- 엄청난 노력을 기울여 도메인 요구사항을 충족하는 전체 시스템을 코드 레벨로 설계하는 것 ❌
- 설계, 특히 구조와 관련이 있거나 영향을 미치는 것들을 찾아내는 것
- 아키텍처 특성이 될만한 것들을 **명시적인 것**과 **암묵적인 것**으로 분류해야 함

</br>

## 5.3.1 명시적 특성
- 요구사항 정의서에 기술되어 있음
- 도메인 레벨에서의 기대치를 고려해야함

</br>

### 유저
- 지금은 수천 명 정도에 불과하지만 향후 수백만 명에 이를 수 있기 때문에, `확장성`이 중요
   → 요구사항 정의서에 기술되어 있지는 않으나, 예상 유저 수를 보고 도메인 언어를 엔지니어링 언어로 해독해야함
- 순간적으로 폭증한 유저 요청을 처리하기 위해서는 **탄력성**도 필요


### 1. 유저 주문 시 샌드위치를 픽업하러 갈 시간 및 상점까지 가는 경로 전달 (교통 정보가 포함된 여러 외부 지도 서비스와의 연계 필수)
- 외부 지도 서비스는 다른 서비스와의 연계하는 것이므로 **신뢰성**에 영향을 미칠 수 있음
- 서드파티 시스템에 의존하면 호출 실패 시 전체 시스템 **안정성**에 타격
- 그러나, 교통 정보가 빠지는 것이 전체 서비스에 엄청난 타격을 주는 것은 아님 → 불필요한 특성이 설계에 반영되는 것 조심

### 2. 배달 서비스가 가능한 지점은 기사를 보내 샌드위치를 유저에게 배달
- 별다른 아키텍처 특성 필요 X

### 3. 모바일 기기에서도 이용이 가능하다.
- 예산이 한정되어 있고 프로그램이 단순해야 한다면, 다수 애플리케이션 제작은 무리
- 모바일에 최적화된 웹 애플리케이션 개발로 방침을 정하고, 로딩 시간/모바일 환경에서 민감한 성능 아키텍처 특성 정의할 수 있음

### 4/5. 전국 어느 지점이나 이용 가능한 프로모션/스페셜 행사를 제공 + 특정 지점에서만 이용 가능한 로컬 프로모션/스페셜 행사 제공
- 프로모션 및 스페셜 행사에 관한 커스터마이징 기능 여부에 관한 요구사항. 1번까지 포함하여 `맞춤성`이라는 특성 도출 가능

### 6. 온라인 결제, 대면 결제, 배송 시 결제 등 다양한 결제 옵션 제공
- 결제의 경우 **보안**이 필요하지만, 어느 정도의 보안이 필요한지 확인 필요

### 7. 샌드위치 지점은 가맹점이므로 소유자가 다 다름
- 비용, 시간, 직원 등의 제약 조건을 적용하는 기능이 필요한지에 대한 **타당성**을 미리 확인해야 함

### 8. 모회사는 머지 않아 해외 시장도 진출할 계획
- **국제화** 필요

### 9. 값싼 인력을 고용해 이윤을 최대화하는 것이 목표
- **사용성**(유저가 쉽게 사용할 수 있어야 많이 사용하니까?)
- 아키텍처 특성 보다는 개발과 더 연관있음

</br>

현재까지 도출된 특성으로는 `확장성`, `맞춤성`
위 요구사항 정의서를 통해 `성능`이라는 세번째 특성을 정의할 수 있음
- 주문이 몰리는 시간에 애플리케이션이 몰리면 문제가 되므로
- 어떤 종류의 성능을 설계에 반영해야할 지? → 6장 참고
- 성능의 기준선을 그어 놓고 특정 수의 유저가 있을 때 어느 정도의 성능이 나와야 수용 가능할 지 정해야 함

</br>


## 5.3.2 암묵적 특성
요구사항 정의서에서 따로 찾을 수 없는 아키텍처 특성

### 가용성
- 유저는 샌드위치 사이트에 접속할 수 있어야 함

### 신뢰성
- 유저가 사이트에 방문해서 시스템을 문제없이 사용해야 함
- 중도에 접속이 끊기거나 문제가 생기면 안됨

### 보안
- 모든 시스템에 공통적인 암묵적 특성
- 다른 아키텍처 특성의 중요도에 따라 우선순위가 달라질 수 있음 → 구조적 측면에 영향/애플리케이션에 매우 중대한 요소일 경우 특성으로 간주
- 실리콘 샌드위치에서 결제는 서드파티 업체가 담당하므로 상식적인 보안 지침만 지키면 됨

### 맞춤성
- 스페셜 행사, 픽업 경로 등을 고려하여 유저에 맞게 정의해야함
- 개발 영역에 속하기도 함. 커스터마이징한 구조에 의존하게 될 경우 아키텍처 특성의 영역
- **📌 개발 vs. 아키텍처 + 트레이드 오프**
  - 아키텍처 특성으로 가져간다면 마이크로 커널 스타일(12장, 플러그인 제공)
  - 개발 특성으로 가져간다면 템플릿 메서드 + 오버라이드 방식으로 커스텀 로직 구현
  - 아키텍트는 트레이드 오프를 분석하고 개발자, PM, 운영팀, 기타 참여자들의 협조를 구해 특성을 결정해야함

### 💡 아키텍처에서 최고의 설계는 없다! 나쁜 것 중 제일 나은 트레이드 오프들만 존재함 (least worse)
- 팀원들과 1차적으로 특성을 식별하고 가장 덜 중요한 것들을 솎아내야 함
- 암묵적 특성은 대부분 당연하게 지켜져야 하는 특성 → 일반적으로 명시적 특성을 추려낼 가능성 높음
- 실리콘 샌드위치에서는 `맞춤성 vs. 성능` 에서 선택해야 함
